!function(){function t(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{cPR9:function(n,i,o){"use strict";o.r(i),o.d(i,"NotificationsModule",function(){return tt});var r,c=o("ofXK"),s=o("tyNb"),u=o("2Vo4"),l=o("nYR2"),b=o("3E0/"),d=o("0EQZ"),g=o("fXoL"),f=o("LRXf"),p=((r=function(){function t(n){e(this,t),this.http=n}return a(t,[{key:"getAll",value:function(t){return this.http.get("notifications/".concat(t,"/subscriptions"))}},{key:"updateUserSubscriptions",value:function(t,n){return this.http.put("notifications/".concat(t,"/subscriptions"),{selections:n})}}]),t}()).\u0275fac=function(t){return new(t||r)(g.Yb(f.a))},r.\u0275prov=g.Kb({token:r,factory:r.\u0275fac,providedIn:"root"}),r),h=o("twBr"),m=o("i2dy"),v=o("kmQS"),y=o("N2vX"),P=o("3Pt+"),w=o("bTqV"),O=o("bSwM");function k(t,n){if(1&t){var e=g.Vb();g.Ub(0,"div",11),g.Ub(1,"div",12),g.Ic(2),g.Tb(),g.Ub(3,"mat-checkbox",13),g.bc("change",function(t){g.xc(e);var i=n.$implicit,a=g.fc(3);return t?a.toggleAllRowsFor(i):null}),g.Tb(),g.Tb()}if(2&t){var i=n.$implicit,a=g.fc(3);g.Cb(2),g.Jc(i),g.Cb(1),g.mc("checked",a.allRowsSelectedFor(i))("indeterminate",a.selections[i].hasValue()&&!a.allRowsSelectedFor(i))("disabled","browser"===i&&!a.supportsBrowserNotifications)}}function C(t,n){if(1&t&&(g.Sb(0),g.Gc(1,k,4,4,"div",10),g.Rb()),2&t){var e=g.fc(2);g.Cb(1),g.mc("ngForOf",e.availableChannels)}}function x(t,n){if(1&t){var e=g.Vb();g.Ub(0,"div",11),g.Ub(1,"mat-checkbox",16),g.bc("click",function(t){return t.stopPropagation()})("change",function(t){g.xc(e);var i=n.$implicit,a=g.fc().$implicit,o=g.fc(2);return t?o.selections[i].toggle(a.notif_id):null}),g.Tb(),g.Tb()}if(2&t){var i=n.$implicit,a=g.fc().$implicit,o=g.fc(2);g.Cb(1),g.mc("checked",o.selections[i].isSelected(a.notif_id))("disabled","browser"===i&&!o.supportsBrowserNotifications)}}function _(t,n){if(1&t&&(g.Ub(0,"div",14),g.Ub(1,"div",15),g.Ic(2),g.Tb(),g.Gc(3,x,2,2,"div",10),g.Tb()),2&t){var e=n.$implicit,i=n.last,a=g.fc(2);g.Gb("no-border",i),g.Cb(2),g.Jc(e.name),g.Cb(1),g.mc("ngForOf",a.availableChannels)}}function U(t,n){if(1&t&&(g.Ub(0,"div",5),g.Ub(1,"div",6),g.Ub(2,"div",7),g.Ic(3),g.Tb(),g.Gc(4,C,2,1,"ng-container",8),g.Tb(),g.Gc(5,_,4,4,"div",9),g.Tb()),2&t){var e=n.$implicit,i=n.first;g.Cb(3),g.Jc(e.group_name),g.Cb(1),g.mc("ngIf",i),g.Cb(1),g.mc("ngForOf",e.subscriptions)}}var M,T,I=((M=function(){function n(t,i,a,o,r,c){e(this,n),this.route=t,this.api=i,this.currentUser=a,this.toast=o,this.cd=r,this.settings=c,this.loading$=new u.a(!1),this.supportsBrowserNotifications="Notification"in window,this.availableChannels=[],this.selections={},this.allNotifIds=[]}return a(n,[{key:"ngOnInit",value:function(){var t=this;this.route.data.subscribe(function(n){t.subscriptions=n.api.subscriptions,t.availableChannels=n.api.available_channels,t.allNotifIds=n.api.all_notif_ids,t.availableChannels.forEach(function(e){t.selections[e]=new d.b(!0,n.api.selections[e])})}),"granted"!==Notification.permission&&this.bindToBrowserNotifSubscription()}},{key:"toggleAllRowsFor",value:function(n){var e;this.allRowsSelectedFor(n)?this.selections[n].clear():(e=this.selections[n]).select.apply(e,t(this.allNotifIds))}},{key:"allRowsSelectedFor",value:function(t){return this.selections[t].selected.length===this.allNotifIds.length}},{key:"saveSettings",value:function(){var t=this;this.loading$.next(!0);var n=this.getPayload();this.api.updateUserSubscriptions(this.currentUser.get("id"),n).pipe(Object(l.a)(function(){return t.loading$.next(!1)})).subscribe(function(){t.toast.open("Notification settings updated.")})}},{key:"getPayload",value:function(){var t=this,n={};return Object.keys(this.selections).forEach(function(e){n[e]=t.selections[e].selected}),n}},{key:"bindToBrowserNotifSubscription",value:function(){var t=this;this.selections.browser.changed.pipe(Object(b.a)(1)).subscribe(function(n){n.added.length&&!n.removed.length&&("denied"===Notification.permission?(t.toast.open("Notifications blocked. Please enable them for this site from browser settings."),t.selections.browser.clear(),t.cd.markForCheck()):Notification.requestPermission().then(function(n){"granted"!==n&&(t.selections.browser.clear(),t.cd.markForCheck())}))})}}]),n}()).\u0275fac=function(t){return new(t||M)(g.Ob(s.a),g.Ob(p),g.Ob(h.a),g.Ob(m.b),g.Ob(g.h),g.Ob(v.a))},M.\u0275cmp=g.Ib({type:M,selectors:[["notification-subscriptions"]],decls:7,vars:5,consts:[[1,"box-shadow",3,"menuPosition"],[1,"be-container"],[1,"table","material-panel",3,"ngSubmit"],["class","setting-group",4,"ngFor","ngForOf"],["mat-raised-button","","color","accent","trans","",1,"submit-button",3,"disabled"],[1,"setting-group"],[1,"row"],["trans","",1,"name-column","strong"],[4,"ngIf"],["class","row indent",3,"no-border",4,"ngFor","ngForOf"],["class","channel-column",4,"ngFor","ngForOf"],[1,"channel-column"],["trans","",1,"channel-name"],[3,"checked","indeterminate","disabled","change"],[1,"row","indent"],["trans","",1,"name-column"],[3,"checked","disabled","click","change"]],template:function(t,n){1&t&&(g.Pb(0,"material-navbar",0),g.Ub(1,"div",1),g.Ub(2,"form",2),g.bc("ngSubmit",function(){return n.saveSettings()}),g.Gc(3,U,6,3,"div",3),g.Ub(4,"button",4),g.gc(5,"async"),g.Ic(6," Save Settings "),g.Tb(),g.Tb(),g.Tb()),2&t&&(g.mc("menuPosition",n.settings.get("vebto.navbar.defaultPosition")),g.Cb(3),g.mc("ngForOf",n.subscriptions),g.Cb(1),g.mc("disabled",g.hc(5,3,n.loading$)))},directives:[y.a,P.E,P.t,P.u,c.n,w.b,c.o,O.a],pipes:[c.b],styles:["[_nghost-%COMP%]{display:block;background-color:var(--be-background-alternative);min-height:100vh}.be-container[_ngcontent-%COMP%]{padding-top:35px;padding-bottom:35px}.table[_ngcontent-%COMP%]{border-radius:4px}.setting-group[_ngcontent-%COMP%]{margin-bottom:10px}.row[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid var(--be-divider-default);padding:10px}.row.no-border[_ngcontent-%COMP%]{border-bottom:none}.row.indent[_ngcontent-%COMP%]{padding-left:20px}.name-column[_ngcontent-%COMP%]{flex:1 1 auto}.strong[_ngcontent-%COMP%]{font-weight:500;font-size:1.5rem;align-self:flex-end}.channel-name[_ngcontent-%COMP%]{margin-bottom:10px}.channel-column[_ngcontent-%COMP%]{width:75px;text-align:center;text-transform:capitalize}.submit-button[_ngcontent-%COMP%]{margin-top:15px}"],changeDetection:0}),M),S=o("JIr8"),F=o("5+tZ"),$=o("EY2u"),N=o("LRne"),A=((T=function(){function t(n,i,a){e(this,t),this.router=n,this.subscriptions=i,this.currentUser=a}return a(t,[{key:"resolve",value:function(t,n){var e=this;return this.subscriptions.getAll(+this.currentUser.get("id")).pipe(Object(S.a)(function(){return e.router.navigate(["/account/settings"]),$.a}),Object(F.a)(function(t){return t?Object(N.a)(t):(e.router.navigate(["/account/settings"]),$.a)}))}}]),t}()).\u0275fac=function(t){return new(t||T)(g.Yb(s.e),g.Yb(p),g.Yb(h.a))},T.\u0275prov=g.Kb({token:T,factory:T.\u0275fac,providedIn:"root"}),T),R=o("f+iI"),j=o("OnlV"),G=o("WWJw"),E=o("Rd8u");function V(t,n){if(1&t){var e=g.Vb();g.Ub(0,"li"),g.Ub(1,"button",4),g.bc("click",function(){g.xc(e);var t=n.$implicit;return g.fc().selectPage(t)}),g.Ic(2),g.Tb(),g.Tb()}if(2&t){var i=n.$implicit,a=g.fc();g.Cb(1),g.Gb("active",a.currentPage===i),g.mc("disabled",a.disabled),g.Cb(1),g.Kc(" ",i," ")}}var B,J,K,L,Y,X=((B=function(){function t(n){e(this,t),this.router=n,this.pageChanged=new g.n,this.disabled=!0}return a(t,[{key:"shouldHide",get:function(){return this.numberOfPages<2}},{key:"pagination",set:function(t){t&&(this.numberOfPages=t.last_page>10?10:t.last_page,this.numberOfPages>1&&(this.iterator=Array.from(Array(this.numberOfPages).keys()).map(function(t){return t+1}),this.currentPage=t.current_page))}},{key:"selectPage",value:function(t){this.currentPage!==t&&(this.currentPage=t,this.pageChanged.next(t),this.router.navigate([],{queryParams:{page:t},replaceUrl:!0}))}},{key:"nextPage",value:function(){var t=this.currentPage+1;this.selectPage(t<=this.numberOfPages?t:this.currentPage)}},{key:"prevPage",value:function(){var t=this.currentPage-1;this.selectPage(t>=1?t:this.currentPage)}}]),t}()).\u0275fac=function(t){return new(t||B)(g.Ob(s.e))},B.\u0275cmp=g.Ib({type:B,selectors:[["pagination-widget"]],hostVars:2,hostBindings:function(t,n){2&t&&g.Gb("hidden",n.shouldHide)},inputs:{disabled:"disabled",pagination:"pagination"},outputs:{pageChanged:"pageChanged"},decls:8,vars:3,consts:[[1,"page-numbers","unstyled-list"],["type","button","mat-button","","trans","",1,"prev",3,"disabled","click"],[4,"ngFor","ngForOf"],["type","button","mat-button","","trans","",1,"next",3,"disabled","click"],["type","button","mat-flat-button","","color","gray",1,"page-number-button",3,"disabled","click"]],template:function(t,n){1&t&&(g.Ub(0,"ul",0),g.Ub(1,"li"),g.Ub(2,"button",1),g.bc("click",function(){return n.prevPage()}),g.Ic(3,"Previous"),g.Tb(),g.Tb(),g.Gc(4,V,3,4,"li",2),g.Ub(5,"li"),g.Ub(6,"button",3),g.bc("click",function(){return n.nextPage()}),g.Ic(7,"Next"),g.Tb(),g.Tb(),g.Tb()),2&t&&(g.Cb(2),g.mc("disabled",n.disabled),g.Cb(2),g.mc("ngForOf",n.iterator),g.Cb(2),g.mc("disabled",n.disabled))},directives:[w.b,E.a,c.n],styles:["[_nghost-%COMP%]{display:block}ul[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;width:100%}li[_ngcontent-%COMP%]{margin:0 3px 6px}.page-number-button[_ngcontent-%COMP%]{width:40px;height:40px;min-width:40px;line-height:40px;padding:0}.active[_ngcontent-%COMP%]{background-color:var(--be-accent-default);color:var(--be-accent-contrast)}.next[_ngcontent-%COMP%], .prev[_ngcontent-%COMP%]{color:var(--be-accent-default)}"],changeDetection:0}),B),q=[{path:"",component:(J=function(){function t(n,i,a,o){e(this,t),this.settings=n,this.notifications=i,this.breakpoints=a,this.route=o,this.pagination$=new u.a(null)}return a(t,[{key:"ngOnInit",value:function(){this.loadPage(this.route.snapshot.queryParams.page||1)}},{key:"loadPage",value:function(t){var n=this;this.notifications.load({page:t,perPage:25}).subscribe(function(t){n.pagination$.next(t.pagination)})}},{key:"markAsRead",value:function(t){this.pagination$.value.data.find(function(n){return n.id===t.id}).read_at=t.read_at}}]),t}(),J.\u0275fac=function(t){return new(t||J)(g.Ob(v.a),g.Ob(R.a),g.Ob(j.a),g.Ob(s.a))},J.\u0275cmp=g.Ib({type:J,selectors:[["notification-page"]],decls:8,vars:13,consts:[[3,"menuPosition"],[1,"be-container"],[3,"notifications","compact","markedAsRead"],[3,"pagination","disabled","pageChanged"]],template:function(t,n){var e;(1&t&&(g.Pb(0,"material-navbar",0),g.Ub(1,"div",1),g.Ub(2,"notification-list",2),g.bc("markedAsRead",function(t){return n.markAsRead(t)}),g.gc(3,"async"),g.gc(4,"async"),g.Tb(),g.Ub(5,"pagination-widget",3),g.bc("pageChanged",function(t){return n.loadPage(t)}),g.gc(6,"async"),g.gc(7,"async"),g.Tb(),g.Tb()),2&t)&&(g.mc("menuPosition",n.settings.get("vebto.navbar.defaultPosition")),g.Cb(2),g.mc("notifications",null==(e=g.hc(3,5,n.pagination$))?null:e.data)("compact",g.hc(4,7,n.breakpoints.isMobile$)),g.Cb(3),g.mc("pagination",g.hc(6,9,n.pagination$))("disabled",g.hc(7,11,n.notifications.loading$)))},directives:[y.a,G.a,X],pipes:[c.b],styles:["[_nghost-%COMP%]{display:block;min-height:100vh;background-color:var(--be-background-alternative)}.be-container[_ngcontent-%COMP%]{padding-top:25px;padding-bottom:25px}pagination-widget[_ngcontent-%COMP%]{margin-top:35px}"],changeDetection:0}),J)},{path:"settings",component:I,resolve:{api:A},data:{permissions:["notification.subscribe"]}}],z=((K=function t(){e(this,t)}).\u0275mod=g.Mb({type:K}),K.\u0275inj=g.Lb({factory:function(t){return new(t||K)},imports:[[s.i.forChild(q)],s.i]}),K),D=o("MKyN"),W=o("CXWK"),H=o("gFpt"),Q=o("6rvT"),Z=((Y=function t(){e(this,t)}).\u0275mod=g.Mb({type:Y}),Y.\u0275inj=g.Lb({factory:function(t){return new(t||Y)},imports:[[c.c,w.c,Q.a]]}),Y),tt=((L=function t(){e(this,t)}).\u0275mod=g.Mb({type:L}),L.\u0275inj=g.Lb({factory:function(t){return new(t||L)},imports:[[c.c,P.m,P.z,z,H.a,D.a,W.a,Z,O.b,w.c]]}),L)}}])}();